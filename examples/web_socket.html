<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>WebSocket Server Test</title>
        <meta charset="UTF-8">
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js" type="text/javascript"></script>
        <script type="text/javascript">
        $(document).ready(function(){
            web_socket = new WebSocket("ws://127.0.0.1:8080/trial", "Elements-test")

            web_socket.onclose = function(e) {
                // Disable WebSocket Buttons
                $("#button-get-conn-info, #button-get-cur-time, #button-close").attr("disabled", true)
            }
            web_socket.onopen = function(e) {
                // Enable WebSocket Buttons
                $("#button-get-conn-info, #button-get-cur-time, #button-close").attr("disabled", false)
            }
            web_socket.onmessage = function(e) {
                console.log("WebSocket Message")
                console.log(e)
                in_data = e.data.split("|")

                if (in_data[0] == "RESET" && in_data[1] == "RESET") {
                    // Empty incoming data
                    $("#incoming-data").empty()
                } else {
                    // Write message into incoming data
                    $("#incoming-data").append(in_data[0]+": "+in_data[1]+"\n");
                }
            }

        });

        incoming_data_list = document.getElementById("incoming-data-list")

        function add_incoming_data_item(name, value) {
            alert(incoming_data_list.innerHTML)
        }
        </script>
        <style type="text/css">
        <!--
        dt { width: 8em; float: left; clear: left; font-weight: bold; }
        dd { float: left; clear: right; margin: 0; padding: 0; }
        -->
        </style>
    </head>
    <body>
        <h1>WebSocket Server Test</h1>
        <div id="button-controls">
            <button id="button-get-conn-info" onclick="web_socket.send('CONN_INFO')" disabled="disabled">Get Connection Info</button>
            <button id="button-get-cur-time" onclick="web_socket.send('CUR_TIME')" disabled="disabled">Get Current Time</button>
            <button id="button-close" onclick="web_socket.close()" disabled="disabled">Close WebSocket</button>
        </div>
        <h2>WebSocket Incoming Data</h2>
        <pre id="incoming-data"></pre>
    </body>
</html>

